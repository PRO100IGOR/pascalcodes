{*******************************************************}
{                                                       }
{       Pascal Script Source File                       }
{       Run by RemObjects Pascal Script in CnWizards    }
{                                                       }
{       Generated by CnPack IDE Wizards                 }
{                                                       }
{       Note: This script must run under Delphi 2009    } 
{             or Later to Support BuildConfiguration.   }
{                                                       }
{*******************************************************}

program BuildConfiguration;

uses
  Windows, Messages, SysUtils, Classes, Graphics, Controls, Forms, Dialogs;

var
  BC: IOTAProjectOptionsConfigurations;
  I: Integer;
begin
  if (CompilerKind = ckDelphi) and ((Compiler = cnDelphi12) or 
    (Compiler = cnDelphi14) or (Compiler = cnDelphi15) or (Compiler = cnDelphi16)) then
  begin
    BC := CnOtaGetActiveProjectOptionsConfigurations(nil);
    if BC <> nil then
    begin
      ShowMessage('Current Project''s Configuration Count: ' + IntToStr(BC.GetConfigurationCount));
      for I := 0 to BC.GetConfigurationCount - 1 do
      begin
        if BC.GetConfiguration(I).GetName = BC.GetActiveConfiguration.GetName then
          ShowMessage(Format('Configuration %d (Active): ', [I]) + BC.GetConfiguration(I).GetName)
        else
          ShowMessage(Format('Configuration %d: ', [I]) + BC.GetConfiguration(I).GetName);
      end;
    end;

    if QueryDlg('Test: Do you want to Set Active Configuration to Index 1?', True) then
      BC.SetActiveConfiguration(BC.GetConfiguration(1));
  end
  else
    ErrorDlg('Only Support Delphi 2009 and Later.');
end.

